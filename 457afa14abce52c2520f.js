(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{170:function(e,t){},390:function(e,t,i){},402:function(e,t,i){"use strict";var r=i(390);i.n(r).a},417:function(e,t,i){"use strict";i.r(t);var r=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"card"},[e._m(0),i("div",{staticClass:"card__content"},[i("form",{staticClass:"edit-form edit-form--reviews form--strong",on:{submit:function(t){return t.preventDefault(),e.reviewCard(e.newReview)},reset:function(t){return t.preventDefault(),e.hideAddingCard(t)}}},[i("div",{staticClass:"edit-form__column"},[i("input",{staticClass:"edit-form__file",attrs:{type:"file",name:"reviews-image",id:"upload-pic"},on:{change:e.appendFileAndRenderPhoto}}),i("div",{staticClass:"edit-form__row"},[i("div",{staticClass:"edit-form__frame",class:{filled:e.renderedPhoto.length},style:e.renderedBackground})]),e._m(1),i("vc-tooltip-input",{attrs:{errorText:e.validation.firstError("newReview.photo")}})],1),i("div",{staticClass:"edit-form__column"},[i("div",{staticClass:"edit-form__row-double"},[i("div",{staticClass:"edit-form__row"},[i("vc-input",{attrs:{type:"text",name:"author",title:"Имя автора",placeholder:"Ковальчук Дмитрий",errorText:e.validation.firstError("newReview.author")},model:{value:e.newReview.author,callback:function(t){e.$set(e.newReview,"author",t)},expression:"newReview.author"}})],1),i("div",{staticClass:"edit-form__row"},[i("vc-input",{attrs:{type:"text",name:"occ",title:"Титул автора",placeholder:"Основатель LoftSchool",errorText:e.validation.firstError("newReview.occ")},model:{value:e.newReview.occ,callback:function(t){e.$set(e.newReview,"occ",t)},expression:"newReview.occ"}})],1)]),i("div",{staticClass:"edit-form__row"},[i("vc-input",{attrs:{type:"textarea",name:"text",title:"Отзыв",placeholder:"Этот парень проходил обучение веб-разработке не где-то, а в LoftSchool! 4,5 месяца только самых тяжелых испытаний и бессонных ночей!",errorText:e.validation.firstError("newReview.text")},model:{value:e.newReview.text,callback:function(t){e.$set(e.newReview,"text",t)},expression:"newReview.text"}})],1),i("div",{staticClass:"edit-form__row"},[i("div",{staticClass:"controls edit-form__btns"},[e._m(2),i("div",{staticClass:"controls__btn"},[i("button",{staticClass:"btn btn--gradient",class:{"is-blocked":e.isBlocked},attrs:{type:"submit"}},[e._v("Сохранить")])])])])])])])])};r._withStripped=!0;var n=i(64),o=i.n(n),a=i(50);function s(e,t,i,r,n,o,a){try{var s=e[o](a),c=s.value}catch(e){return void i(e)}s.done?t(c):Promise.resolve(c).then(r,n)}function c(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?Object(arguments[t]):{},r=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(i).filter(function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable}))),r.forEach(function(t){d(e,t,i[t])})}return e}function d(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var l=o.a.Validator,u={mixins:[o.a.mixin],name:"reviews-add-new",props:{review:Object},data:function(){return{isBlocked:!1,renderedPhoto:"",newReview:c({},this.review)}},components:{vcInput:function(){return i.e(0).then(i.bind(null,410))},vcTooltipInput:function(){return i.e(2).then(i.bind(null,418))}},validators:{"newReview.author":function(e){return l.value(e).required("Поле обязательно к заполнению")},"newReview.occ":function(e){return l.value(e).required("Поле обязательно к заполнению")},"newReview.text":function(e){return l.value(e).required("Поле обязательно к заполнению")},"newReview.photo":function(e){return l.value(e).required("Поле обязательно к заполнению")}},methods:c({},Object(a.b)("reviews",["saveReview","updateReview"]),{hideAddingCard:function(){this.$emit("hideAddingCard")},appendFileAndRenderPhoto:function(e){var t=this;this.newReview.photo=e.target.files[0];var i=new FileReader;try{i.readAsDataURL(this.newReview.photo),i.onload=function(){t.renderedPhoto=i.result}}catch(e){}},reviewCard:function(){var e,t=(e=regeneratorRuntime.mark(function e(t){var i=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$validate();case 2:if(!e.sent){e.next=14;break}if(this.isBlocked=!0,!Object.keys(this.newReview).some(function(e){return i.newReview[e]!==i.review[e]})){e.next=13;break}if(!t.id){e.next=11;break}return e.next=9,this.updateReview(t);case 9:e.next=13;break;case 11:return e.next=13,this.saveReview(t);case 13:this.$emit("hideAddingCard");case 14:case"end":return e.stop()}},e,this)}),function(){var t=this,i=arguments;return new Promise(function(r,n){var o=e.apply(t,i);function a(e){s(o,r,n,a,c,"next",e)}function c(e){s(o,r,n,a,c,"throw",e)}a(void 0)})});return function(e){return t.apply(this,arguments)}}()}),computed:c({},Object(a.c)("reviews",["getReviews"]),{renderedBackground:function(){return this.renderedPhoto?"background-image: url(".concat(this.renderedPhoto,");"):""}}),created:function(){this.newReview=c({},this.review),this.review.photo&&(this.renderedPhoto="https://webdev-api.loftschool.com/"+this.review.photo)},watch:{review:function(){console.log("watch"),this.newReview=c({},this.review),this.renderedPhoto="https://webdev-api.loftschool.com/"+this.review.photo}}},v=(i(402),i(9)),w=Object(v.a)(u,r,[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"card__header"},[t("div",{staticClass:"card__column"},[t("div",{staticClass:"page-subtitle"},[this._v("Новый отзыв")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"edit-form__row"},[t("div",{staticClass:"edit-form__button"},[t("label",{staticClass:"btn btn--link",attrs:{for:"upload-pic"}},[this._v("Добавить фото")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"controls__btn"},[t("button",{staticClass:"btn btn--link",attrs:{type:"reset"}},[this._v("Отмена")])])}],!1,null,"784861d6",null);w.options.__file="src/admin/components/reviews-add-new/reviews-add-new.vue";t.default=w.exports}}]);